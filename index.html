<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>Eugenia Advancement</title>

        <meta name="description" content="Measuring and Tuning Performance of<br/>Virtual Environment Servers:<br/>Experiments With OpenSimulator">
        <meta name="author" content="Eugenia Gabrielova">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/blood.css" id="theme">

        <!-- Code syntax highlighting -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>

    </head>

    <body>

        <div class="reveal">

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">
                <section style="text-align: left;">
                <h4>Measuring and Tuning Performance of<br/>Virtual Environment Servers:<br/>Experiments With OpenSimulator</h4>
                <p>
                Eugenia Gabrielova<br/>Advancement Talk, 3.13.15<br/>University of California, Irvine
                </p>
                <img height="64" src="img/mondego-banner.png"><img height="64" src="img/isr.jpeg" style="margin-left: 0.5em;">
                </section>

                <section>
                    <h4>Virtual environments are online platforms where people can work, play, socialize, and build.</h4>
                    <div style="display: inline-block;"><img height="250" src="img/lopes2013conference.png"></div>
                    <div style="display: inline-block;"><img height="250" src="img/biozone.jpg"></div><br/>
                    <div style="display: inline-block;"><img height="250" src="img/grasshopper.jpg"></div>
                    <div style="display: inline-block;"><img height="250" src="img/oculus.jpg"></div>
                    <div style="display: inline-block;"><img height="250" src="img/gw2.jpg"></div>
                </section>

                <section>
                    <h4>Why research virtual environments?</h4>
                    <blockquote>Despite growing demand, existing systems do not support vast, seamless virtual environments.</blockquote>
                </section>

                <section>
                    <h4>Scope: multi-user real-time virtual environments</h4>
                    <ul>
                        <li>3D virtual environment with many simultaneous users.</li>
                        <li>Environment is accessed through client viewer application.</li>
                        <li>User actions are immediately reflected in the environment and distributed to other users.</li>
                    </ul>
                </section>

                <section>
                    <h4>Many factors impact virtual environment performance.</h4>
                    <ul>
                        <li>Real-time state updates</li>
                        <li>Underlying hardware and network limitations</li>
                        <li>Heterogeneous client viewer implementations</li>
                        <li>Unpredictable user behavior</li>
                    </ul>
                </section>

                <section>
                    <h4>Research Motivation</h4>
                        <blockquote>What techniques can be used to improve performance of virtual environment servers?</blockquote>
                        <p class="fragment zoom-in" style="text-align: left;">Q1. How can virtual environments mitigate unreasonable behavior from clients?</p>
                        <p class="fragment zoom-in" style="text-align: left;">Q2. What part of the login procedure has the highest impact on server performance upon a user joining the environment?</p>
                    </ul>

                     <aside class="notes">
                        zoom in on concrete questions of performance<br>
                        serve more users for the same amount of cycles
					 </aside>
                </section>

                <section>
                    <h4>Contribution</h4>
                    <ul>
                        <li>Experimental design for systematic performance studies of virtual environment servers.</li>
                        <li>Identifies situations in which virtual environment clients behave unreasonably, and shows how to mitigate them.</li>
                        <li>Motivates the study of automated techniques for virtual environment performance measurement.</li>

                        <aside class="notes">
						    In practice, systematic assessment isn't possible.<br>
                            In large complex systems, critical code paths have large performance impact.
					    </aside>
                    </ul>
                </section>

               <section>
                    <h4>Agenda</h4>
                    <ul>
                        <li><b>OpenSimulator, our platform for 3D virtual environment research</b></li>
                        <li>Experiment 1: Systematic study of unreasonable client behavior</li>
                        <li>Experiment 2: Systematic study of server performance impact upon user login.</li>
                        <li>Next Steps and Conclusion: Future research directions for improving performance of virtual environment systems</li>
                    </ul>
                </section>

                <section>
                    <h4>OpenSimulator is an open source 3D virtual environment server.</h4>
                    <div style="display: inline-block;"><img height="300" src="img/lopes2013conference.png"></div>
                </section>

                <section>
                    <h4>OpenSimulator Features</h4>
                    <p><i>[OpenSimulator, 2015, http://opensimulator.org/]</i></p>
                    <ul>
                        <li>Online multi-user 3D simulation servers</li>
                        <li>3D virtual environments of variable sizes</li>
                        <li>Support for multiple clients and protocols</li>
                        <li>Data management and login services for simulation servers</li>
                        <li>Real-time physics simulation</li>
                    </ul>
                </section>

                <section>
                    <h4>OpenSimulator Client Updates</h4> 
                    <p>Clients send streams of updates to simulation server.<p>
                    <div style="display: inline-block; margin-right: 1em; vertical-align: middle;">
                        <img width="500" style="margin: 0; padding: 0;" src="img/packetfull1.png">
                    </div>
                </section>

                <section>
                    <h4>OpenSimulator Client Updates</h4> 
                    <p>Clients send streams of updates to simulation server.<p>
                    <div style="display: inline-block; margin-right: 1em; vertical-align: middle;">
                        <img width="500" style="margin: 0; padding: 0;" src="img/packetfull2.png">
                    </div>
                </section>
        
                <section>
                    <h4>OpenSimulator Client Updates</h4> 
                    <p>Clients send streams of updates to simulation server.<p>
                    <div style="display: inline-block; margin-right: 1em; vertical-align: middle;">
                        <img width="500" style="margin: 0; padding: 0;" src="img/packetsfull3.png">
                    </div>
                </section>

                <section>
                    <h4>OpenSimulator Client Update - Example Steps</h4>
                    <ol>
                        <li>User sits down.</li>
                        <li>User's client viewer sends updated position to <br/>simulation server.</li>
                        <li>Server processes update packet.</li>
                        <li>Server sends update to other users.</li>
                    </ol>
                </section>
                
                <section>
                    <h4>Agenda</h4>
                    <ul>
                        <li>OpenSimulator, our platform for 3D virtual environment research</li>
                        <li><b>Experiment 1: Systematic study of unreasonable client behavior</b></li>
                        <li>Experiment 2: Systematic study of server performance impact upon user login.</li>
                        <li>Next Steps and Conclusion: Future research directions for improving performance of virtual environment systems</li>
                    </ul>
                </section>

                <section>
                    <h4>Experiment 1 Motivation: Unreasonable client behavior in a virtual conference setting</h4>
                    <p><b>Observation:</b> Server load increased when certain clients entered virtual environment.</p>
                </section>

                <section>
                    <h4>Experiment 1 Motivation: Unreasonable client behavior in a virtual conference setting</h4>
                    <p><b>Cause:</b> Clients sent update streams to server with tiny position changes.</p>
                    <img height="100" src="img/unstable_icon.png"><img height="100" src="img/unstable_example.png">
                    <aside class="notes">
					    At best, floating point issues in client implementation.
                        At worst, malicious client.
                        Client viewers are separate projects - can't control them.
					</aside>         
                </section>

                <section>
                    <h4>Experiment 1 Motivation: Unreasonable client behavior in a virtual conference setting</h4>
                    <p><b>Engineering Solution:</b> Added filter <i>early</i> in processing stage to discard agent update packets with insignificant position update values.</p>
                    <img height="100" src="img/unstable_icon.png"><img height="100" src="img/exp_1_motivation_filter.png">
                </section>

                <section>
                    <h4>Experiment 1 Motivation: Unreasonable client behavior in a virtual conference setting</h4>
                    <blockquote>Q1. How can virtual environments mitigate unreasonable behavior from clients?</blockquote>
                </section>

                <section>
                <h4>Experiment 1: Experiment Design</h4>
                <ol>
                    <li><b>To simulate conference,</b> users enter scene and sit down</li>
                    <li><b>To control client behavior,</b> used synthetic client bots</li>
                    <li><b>To eliminate noise,</b> built barebones environment</li>
                    <li><b>To measure performance impact,</b> measured steady-state server load</li>
                    <li><b>To collect data,</b> used OpenSimulator internal monitoring framework</li>
                </ol>

                <aside class="notes">
                    sweet spot between emulating user behavior and eliminating enough noise to systematically study behavior
                </aside>

                </section>

                <section>
                <h4>Experiment 1: Experiment Design</h4>
                <p>Sitting down removes a user from the physics simulation.</p>
                <div style="display: inline-block;"><b>OpenSim Load Test</b><br><img height="275" src="img/loadtest.jpg"></div>
                <div style="display: inline-block;"><b>Our Experiment</b><br><img height="275" src="img/impact_bots_sitting.png"></div>
                </section>

                <section>
                <h4>Experiment 1: Findings - Server Load</h4>
                <div style="display: inline-block;"><img height="400" src="img/annotated_res.png"></div><br/>
                </section>

                <section>
                <h4>Experiment 1: Findings - Agent Update Packets</h4>
                <div style="display: inline-block;"><img height="400" src="img/ReceivedBig.png"></div>
                </section>

                <section>
                <h4>Experiment 1: Findings - Agent Update Packets</h4>
                <div style="display: inline-block;"><img height="400" src="img/ProcessedBig.png"></div>
                </section>

                <section>
                <h4>Experiment 1: Findings - Agent Update Packets</h4>
                <div style="display: inline-block;"><img height="400" src="img/SentBigger.png"></div>
                </section>

                <section>
                <h4>Experiment 1: Lessons Learned</h4>
                <ul>
                    <li>Our experiments confirm that filtering optimization worked.</li> <!-- measurable significant performance impact -->
                    <li>Initial agent processing code is a critical code path.</li>
                    <li>Shows one strategy by which virtual environment servers can mitigate unreasonable client behavior.</li>
                </ul>
                </section>

               <section>
                    <h4>Agenda</h4>
                    <ul>
                        <li>OpenSimulator, our platform for 3D virtual environment research</li>
                        <li>Experiment 1: Systematic study of unreasonable client behavior</li>
                        <li><b>Experiment 2: Systematic study of server performance impact upon user login</b></li>
                        <li>Next Steps and Conclusion: Future research directions for improving performance of virtual environment systems</li>
                    </ul>
                </section>

                <section>
                <h4>Experiment 2: Exploring Performance Impact <br/>of User Login</h4>
                <b>Goal:</b> Understanding why the entrance of a user into a virtual environment is such a heavy process.
                <img height="300" src="img/loadspike.png">
                </section>

                <section>
                <h4>Experiment 2: Exploring Performance Impact <br/>of User Login - Login Steps</h4>
                <ol>
                    <li>User enters environment through client viewer.</li>
                    <li>Client requests scene and inventory from server</li>
                    <li>Server checks permissions, then sends scene and inventory to client.</li>
                    <li>Client viewer loads scene and inventory.</li>
                </ol>
                </section> 

                <section>
                <h4>Experiment 2: Exploring Performance Impact <br/>of User Login - Experiment Design</h4>
                <ul>
                    <li>Three Factors: Inventory Size, Avatar Complexity, Scene Complexity</li>
                    <li>Measure server load for 10 minutes after user login.</li>
                    <li>Clear cache - user in each experiment enters a "new" scene</li>
                    <li>Control complexity of the experiment - measure load of a single user</li> As simple as possible while still being significant
                </ul>
                </section>

                <section>              
                    <h4>Experiment 2: Performance Factors - Inventories</h4>
                    <img height="300" src="img/inventories.png">
                </section>

                <section>              
                    <h4>Experiment 2: Performance Factors - Avatars</h4>
                    <img height="300" src="img/ruth-char.png"><img height="300" src="img/alien-char.png">
                </section>

                <section>              
                    <h4>Experiment 2: Performance Factors - Scenes</h4>
                    <img height="200" src="img/basic-scene_001.png"><img height="200" src="img/reticulation.png">
                </section>

                <section>              
                    <h4>Experiment 2: Experiment Setup</h4>
                    <img height="300" src="img/simulation-server-local-inventory.png">
                </section>

                <section>              
                    <h4>Experiment 2: Performance Findings - Inventories</h4>
                    <p>TODO</p>
                </section>

                <section>              
                    <h4>Experiment 2: Performance Findings - Avatars</h4>
                    <p>TODO</p>
                </section>

                <section>              
                    <h4>Experiment 2: Performance Findings - Scenes</h4>
                    <p>TODO</p>
                </section>

                <section>              
                    <h4>Experiment 2: Follow-Up Study Adds Dedicated Inventory Server</h4>
                    <img height="300" src="img/simulation-server-dedicated-inventory.png">
                </section>                          

                <section>
                <h4>Experiment 2: Findings of Follow-up Study with Dedicated Server</h4>
                <img height="300" src="img/organized_by_inventory.png">            
                </section>

                <section>
                <h4>Experiment 2: Exploring Performance Impact <br/>of User Login - Findings</h4>
                For users with heavy inventory, server loads decreased by 63.9% - 88.9% after dedicated server was added.<br/>
                <img height="300" src="img/organized_by_inventory_heavy.png">             
                </section>

                <section>
                <h4>Experiment 2: Exploring Performance Impact of User Login - Findings</h4>
                <ul>
                    <li>Manual overhead of realistic virtual environment experiments is heavy.</li>
                    <li>One client configuration exhibited unreasonable behavior during some logins.</li>
                </ul>
                </section>

               <section>
                    <h4>Agenda</h4>
                    <ul>
                        <li>OpenSimulator, our platform for 3D virtual environment research</li>
                        <li>Experiment 1: Systematic study of unreasonable client behavior</li>
                        <li>Experiment 2: Systematic study of server performance impact upon user login</b></li>
                        <li><b>Next Steps and Conclusion: Future research directions for improving performance of virtual environment systems</b></li>
                    </ul>
                </section>

                <section>
                    <h4>Research Motivation</h4>
                    <blockquote>What techniques can be used to improve performance of virtual environment servers?</blockquote>
                    
                    <p class="fragment zoom-in" style="text-align: left;">&#x2713; Systematic studies of mitigation strategies for unreasonable client resource demands.<p>
                    <p class="fragment zoom-in" style="text-align: left;"><b>Next:</b> Automating systematic performace studies of virtual environment systems<p>  
                </section>                

                <section>
                    <h4>Future Work: Automating systematic performace studies of virtual environment servers</h4>
                    <ul>
                        <li>Synthetic load test clients that cause realistic server load</li>
                        <li>Automated systematic study workflows</li>
                        <li>Record and replay capability for virtual environment testing<br/>(e.g., Selenium for web applications <i>[Bruns et. al., 2009; Holmes & Kellogg, 2006]</i>)</li>
                    </ul>

                    <aside class="notes">
                        trade-off between automation and realism<br/>
                        global distribution of clients
					</aside>
                </section>

                <section>
                    <h4>Conclusions</h4>
                    <ul>
                        <li>Virtual environment experiment design isn't easy!</li>
                        <li>Systematic performance studies help pinpoint performance issues.</li>
                        <li>Critical code paths in virtual environments can have significant performance impact.</li>
                        <li>Automated techniques needed to address manual overhead of virtual environment experiments.</li>
                    </ul>
                </section>
            </div>

        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>
        <script>

            // Full list of configuration options available at:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,

                transition: 'slide', // none/fade/slide/convex/concave/zoom

                // Optional reveal.js plugins
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true },
                    { src: 'plugin/notes/notes.js', async: true }
                ]
            });

        </script>

    </body>
</html>
